#!/usr/bin/env python
# coding: utf-8
__author__ = 'zhenghuabin'


def config_alarm(conf):
    global _nsq_writer
    if _nsq_writer:
        return
    if not conf:
        from pyutil.program.conf2 import Conf

        conf = Conf('/etc/ss_conf/nsq_web.conf')

    from ss_data.mq.nsq_init import NsqInitor
    _nsq_writer = NsqInitor(conf).get_nsq_writer(keepalive=True)


def get_alarm_writer():
    global _nsq_writer
    if not _nsq_writer:
        config_alarm(None)
    return _nsq_writer


_nsq_writer = None

#!/usr/bin/env python
# coding: utf-8
__author__ = 'zhenghuabin'

from hierarchical_auth.backends import HierarchicalModelBackend
from pyutil.django.base_backends import (
        PermissionOnlyModelBackend, AuthFrequencyControl,
        FrequencyLDAPBackend, FrequencyModelBackend
        )


class PermissionOnlyHierarchicalModelBackend(HierarchicalModelBackend):
    def authenticate(self, username=None, password=None):
        return None


class FrequencyHierarchicalModelBackend(HierarchicalModelBackend):
    def authenticate(self, username, password):
        if not AuthFrequencyControl.check_frequency(username):
            return None
        ret = super(FrequencyHierarchicalModelBackend, self).authenticate(username, password)
        if not ret:
            AuthFrequencyControl.mark_failed(username)

#!/usr/bin/env python
#coding: utf-8

import ujson, time
from kafka_proxy import KafkaProxy
from pyutil.program.conf import Conf
from pyutil.program.log import logging_config

def main():
    conf = Conf("/opt/tiger/ss_conf/ss/kafka.conf")
    conf = Conf("/home/huxiao/repos/ss_conf/ss/kafka.conf")
    handler = KafkaProxy(topic="client_side_sessions", consumer_group="test_group", partitions=5,conf=conf)

    index = 0
    while True:
        t0 = time.time()
        rets = handler.fetch_msgs(count=4096)
        print rets[:10]
        return
        t1 = time.time()
        if rets:
            print "fetch %s result ,cost %s second, first data is %s" %(len(rets), t1 - t0, rets[0])
            index += 1
        else:
            print "no data"
            time.sleep(1)
        if index >= 15:
            break
        
if __name__ == "__main__":
    logging_config(log_file='./xxxx.log')
    main()


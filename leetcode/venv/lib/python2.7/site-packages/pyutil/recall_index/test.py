import struct, sys, time
from index_service.ttypes import BatchUpdateReq, BatchUpdateRsp, GidScore, SearchReq, FidScore, SearchKvReq, SearchKvRsp, BatchUpdateKvRsp, BatchUpdateKvReq,SearchFeatureReq, FeatureScore, OpReq, SubSearchFeatureReq, MultiSearchFeatureReq, ScanRsp, ScanReq
from index_updater.ttypes import UpdateKvMultiSvrReq, UpdateMultiSvrRsp

from index_service_client import ThriftIndexServiceClient
#from smart_index_service_client import ThriftIndexServiceClient

client = ThriftIndexServiceClient(["10.10.48.220"], [9989], timeout=10, conn_timeout=1)
#client = ThriftIndexServiceClient("data.index_service.cypher_partition", "nim", timeout=1, conn_timeout=1)

req = ScanReq("cypher_group_data_recent", -1, None, True)

rsp = client.scan(req)

print rsp
print len(rsp.compress_result)

for m in rsp.res:
    print m

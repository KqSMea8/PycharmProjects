#!/bin/bash
program=redis-server
curr_dir=$(dirname $0)
nohup_log=$curr_dir/log/nohup.out

function stat {
    pgrep -u $USER -f 5898 | xargs -r ps u -p
}

function start {
    bin=/opt/tiger/twemproxy_bin/bin/redis-server

    mkdir -p $curr_dir/log

    nohup $bin $curr_dir/conf/redis.master.conf 1>>$nohup_log 2>&1 &

    sleep 0.1
    echo "[PROCESS LIST AFTER OPERATION]"
    stat
}

function stop {
    pgrep -u $USER -f 5898 | xargs -r kill -9
}

if [ "x$1" == "xstart" ]; then
    stop
    sleep 0.5
    start
elif [ "x$1" == "xstop" ]; then
    stop
elif [ "x$1" == "xrestart" ]; then
    stop
    sleep 0.5
    start
elif [ "x$1" == "xstat" ]; then
    stat
else
    echo "usage: $0 stat|start|stop|restart"
    exit 1
fi


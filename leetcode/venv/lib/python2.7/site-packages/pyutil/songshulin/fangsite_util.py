#coding=utf-8

import time, logging
FLOOR_TYPE_TO_NAME = {
    0:u"未知楼层",
    1:u"一层",
    2:u"低楼层",
    3:u"中间楼层",
    4:u"高楼层",
    5:u"顶层",
}
def tran_price(price):
    res = ""
    try:
        price = int(price)
        if price > 0:
            if price < 10000:
                res = u"%d元"%price
            else:
                price = price/10000.0
                res = u"%.2f"%price
                if res.endswith(u'.00'):
                    res = res[:-3]
                elif res.endswith(u'0'):
                    res = res[:-1]
                res = u"%s万"%res
    except:
        logging.exception("Trans price exception")
    return res

def tran_room(room_number, hall_number):
    room = ""
    if room_number == 1 and hall_number == 0:
        room = u"单间"
    elif room_number != -1:
        room = u"%d室"%room_number
        if hall_number != -1:
            room += u"%d厅"%hall_number
    elif room_number == -1:
        if hall_number != -1:
            room = u"%d厅"%hall_number
    return room

def tran_floor(floor_type, total_floor):
    floor = FLOOR_TYPE_TO_NAME.get(floor_type, u"未知楼层")
    if total_floor > 0:
        t_floor = u"%s/%d层" %(floor, total_floor)
    else:
        t_floor = u"%s" %floor
    return t_floor

def tran_publish_time(publish_time, mode=None):
    publish_time = int(publish_time) + 300
    time_now = int(time.time())
    time_diff = (time_now - publish_time)/60

    if mode == 'aggregation':
        if time_diff > 2*24*60:
            day_diff = time_diff%(24*60)>0 and time_diff/(24*60)+1 or time_diff/(24*60)
            return u"%d天内"%int(day_diff)
        elif time_diff > 24*60 and time_diff <= 2*24*60:
            return u"昨天"
        else:
            return u"今天"
    else:
        if time_diff > 2*24*60:
            day_diff = time_diff%(24*60)>0 and time_diff/(24*60)+1 or time_diff/(24*60)
            return u"%d天内"%int(day_diff)
        elif time_diff > 24*60 and time_diff <= 2*24*60:
            return u"昨天"
        elif time_diff >= 60:
            return "%d小时前"%int(time_diff/60)
        else:
            if time_diff <= 1:
                return "1分钟前"
            else:
                return "%d分钟前"%time_diff

def tran_toward(toward):
    if type(toward) == unicode:
        toward = toward.encode('utf8')
    if toward in ['东','西','南','北']:
        return "单面朝%s"%toward
    elif toward != "":
        return "朝向%s"%toward
    else:
        return toward

